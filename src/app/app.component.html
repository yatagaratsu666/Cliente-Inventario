<header>
  <div class="logo">Nexus Battles IV</div>

  <div *ngIf="!router.url.startsWith('/battle/')" class="nav-container">
    <nav class="nav-links">
      <a (click)="onPlay()">Jugar Online</a>
      <a (click)="onMission()">Misiones</a>
      <a (click)="onAuction()">Subastas</a>
      <a (click)="onTournament()">Torneo</a>
      <a (click)="onInventory()">Mi Inventario</a>
      <a (click)="openLogin()">Mi Cuenta</a>
      <div class="dropdown" *ngIf="isRole()">
        <a>Panel Gesti√≥n</a>
        <div class="dropdown-menu">
          <a (click)="goToGestion('heroes')">Gesti√≥n de H√©roes</a>
          <a (click)="goToGestion('items')">Gesti√≥n de √çtems</a>
          <a (click)="goToGestion('weapons')">Gesti√≥n de Armas</a>
          <a (click)="goToGestion('armors')">Gesti√≥n de Armaduras</a>
          <a (click)="goToGestion('epics')">Gesti√≥n de √âpicos</a>
        </div>
      </div>
    </nav>

    <!-- Contenedor relativo para buscador y resultados -->
    <div class="search-container">
      <input
        type="text"
        class="search-bar"
        placeholder="Buscar..."
        [(ngModel)]="searchQuery"
        (input)="onSearchChange()"
      />

      <!-- Dropdown de resultados -->
      <div class="search-results" *ngIf="searchQuery">
        <div *ngIf="items.length">
          <strong>√çtems</strong>
          <ul>
            <!-- üîπ Clic en √≠tem abre comentarios -->
            <li
              *ngFor="let item of items"
              class="search-result"
              (click)="openComentariosItem(item)"
            >
              {{ item.name }}
            </li>
          </ul>
        </div>

        <div *ngIf="heroes.length">
          <strong>H√©roes</strong>
          <ul>
            <!-- üîπ Clic en h√©roe abre comentarios -->
            <li
              *ngFor="let hero of heroes"
              class="search-result"
              (click)="openComentariosItem(hero)"
            >
              {{ hero.name }}
            </li>
          </ul>
        </div>

        <div *ngIf="armors.length">
          <strong>Armaduras</strong>
          <ul>
            <!-- üîπ Clic en armadura abre comentarios -->
            <li
              *ngFor="let armor of armors"
              class="search-result"
              (click)="openComentariosItem(armor)"
            >
              {{ armor.name }}
            </li>
          </ul>
        </div>

        <div *ngIf="epics.length">
          <strong>√âpicos</strong>
          <ul>
            <!-- üîπ Clic en √©pico abre comentarios -->
            <li
              *ngFor="let epic of epics"
              class="search-result"
              (click)="openComentariosItem(epic)"
            >
              {{ epic.name }}
            </li>
          </ul>
        </div>

        <div *ngIf="weapons.length">
          <strong>Armas</strong>
          <ul>
            <!-- üîπ Clic en arma abre comentarios -->
            <li
              *ngFor="let weapon of weapons"
              class="search-result"
              (click)="openComentariosItem(weapon)"
            >
              {{ weapon.name }}
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  
<div class="logout-wrapper">
  <button class="logout-button" *ngIf="loginService?.isLoggedIn()" (click)="logout()">
    Cerrar sesi√≥n
  </button>
</div>


  <!-- Chatbot -->
  <div class="chatbot-container" *ngIf="chatbotVisible">
    <div class="chatbot-header" (click)="toggleChatbot()">
      NexusBot
      <span style="float: right; cursor: pointer;">√ó</span>
    </div>

    <div class="chatbot-suggestions" *ngIf="chatbotMessages.length === 0">
      <button
        *ngFor="let suggestion of chatbotSuggestions"
        (click)="sendSuggestion(suggestion)"
      >
        {{ suggestion }}
      </button>
    </div>

    <div class="chatbot-messages">
      <div *ngFor="let msg of chatbotMessages" [ngClass]="msg.from">
        {{ msg.text }}
      </div>

      <div *ngIf="isProcessing" class="bot">Pensando...</div>
    </div>

    <div class="chatbot-input">
      <input
        [(ngModel)]="chatbotInput"
        (keyup.enter)="sendChatMessage()"
        placeholder="Escribe un mensaje..."
      />
      <button (click)="sendChatMessage()">Enviar</button>
    </div>
  </div>

  <div class="chatbot-toggle-button" (click)="toggleChatbot()" *ngIf="!chatbotVisible">
    üí¨
  </div>
</header>

<!-- Barra de notificaciones -->
<div class="notification-bar" *ngIf="mostrarNotificaciones">
  <div class="notification-header">
    <span class="notification-title">Notificaciones</span>
    <button class="close-btn" (click)="cerrarNotificaciones()">‚úï</button>
  </div>

  <div class="notification-content">
    <p *ngIf="!notificaciones.length">Sin notificaciones pendientes</p>
    <ul *ngIf="notificaciones.length">
      <li *ngFor="let notificacion of notificaciones">{{ notificacion }}</li>
    </ul>
  </div>
</div>




<router-outlet></router-outlet>
<router-outlet></router-outlet>
<app-toast></app-toast>
<app-cuenta [isOpen]="isLoginOpen"></app-cuenta>
